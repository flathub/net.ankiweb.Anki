{
  "app-id": "net.ankiweb.Anki",
  "runtime": "org.kde.Platform",
  "runtime-version": "5.9",
  "sdk": "org.kde.Sdk",
  "command": "anki",
  "finish-args": [
     "--socket=x11",
     "--socket=wayland",
     "--share=network",
     "--share=ipc",
     "--device=dri"
  ],
  "rename-desktop-file": "anki.desktop",
  "modules": [
    {
      "name": "cpython",
      "sources": [
        {
          "type": "archive",
          "url": "https://www.python.org/ftp/python/3.6.6/Python-3.6.6.tar.xz",
          "sha256": "d79bc15d456e73a3173a2938f18a17e5149c850ebdedf84a78067f501ee6e16f"
        }
      ]
    },
    {
      "name": "portaudio",
      "sources": [
        {
          "type": "archive",
          "url": "http://www.portaudio.com/archives/pa_stable_v190600_20161030.tgz",
          "sha256": "f5a21d7dcd6ee84397446fa1fa1a0675bb2e8a4a6dceb4305a8404698d8d1513"
        }
      ],
      "cleanup": [
        "/app/lib/pkgconfig",
        "/app/lib/libportaudio.a",
        "/app/lib/libportaudio.la",
        "/app/include"
      ]
    },
    {
      "name": "pyqt5",
      "config-opts": [ "--disable-static", "--enable-x11" ],
      "no-autogen": true,
      "buildsystem": "simple",
      "build-commands": [
        "python3 configure.py --assume-shared --confirm-license --no-designer-plugin --no-qml-plugin --sysroot=/app -w --sip=/app/bin/sip --sip-incdir=/app/include -verbose QMAKE_CFLAGS_RELEASE='-I/app/include/python3.6m/' QMAKE_CXXFLAGS_RELEASE='-I/app/include/python3.6m/'",
        "make -j `nproc`",
        "make install DESTDIR=/app"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://sourceforge.net/projects/pyqt/files/PyQt5/PyQt-5.9.2/PyQt5_gpl-5.9.2.tar.gz",
          "sha256": "c190dac598c97b0113ca5e7a37c71c623f02d1d713088addfacac4acfa4b8394"
        }
      ],
      "modules": [
        {
          "name": "sip",
          "sources": [
            {
              "type": "archive",
              "url": "https://sourceforge.net/projects/pyqt/files/sip/sip-4.19.8/sip-4.19.8.tar.gz",
              "sha256": "7eaf7a2ea7d4d38a56dd6d2506574464bddf7cf284c960801679942377c297bc"
            }
          ],
          "buildsystem": "simple",
          "build-commands": [
            "python3 configure.py --bindir=/app/bin --destdir=/app/lib/python3.6/site-packages --incdir=/app/include --pyidir=/app/lib/python3.6/site-packages --sipdir=/app/share/sip",
            "make",
            "make install"
          ],
          "cleanup": [
            "/bin",
            "/include"
          ]
        }
      ]
    },
    "python3-decorator.json",
    "python3-pyaudio.json",
    "python3-bs4.json",
    "python3-requests.json",
    "python3-send2trash.json",
    "python3-markdown.json",

    {
      "name": "anki",
      "sources": [
        {
          "type": "archive",
          "url": "https://apps.ankiweb.net/downloads/current/anki-2.1.3-source.tgz",
          "sha256": "7569cafa71eb83fe2399a5d20f7e32c0b6073bca543bdb45b001402769bea699"
        },
        {
          "type": "file",
          "path": "net.ankiweb.Anki.svg"
        },
        {
          "type": "file",
          "path": "net.ankiweb.Anki.appdata.xml"
        }
      ],
      "buildsystem": "simple",
      "build-commands": [
          "sed -i -e 's/Icon=anki/Icon=net.ankiweb.Anki/' anki.desktop",
          "sed -i -e '/xdg-mime/d' Makefile",
          "sed -i -e 's/cp -a/cp -dR/' Makefile",
          "make install PREFIX=/app",
          "install -D -t /app/share/icons/hicolor/scalable/apps net.ankiweb.Anki.svg",
          "install -D -t /app/share/appdata net.ankiweb.Anki.appdata.xml",
          "install -D anki.xml /app/share/mime/packages/net.ankiweb.Anki.xml"
      ]
    }
  ]
}
